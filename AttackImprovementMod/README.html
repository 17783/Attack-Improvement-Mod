<title>BATTLETECH Attack Improvement Mod</title>
<style>
.warn { font-weight: bold; color: red; clear: both; float: left; }
</style>

<h1>AIM: Attack Improvement Mod</h1>
<p>
   Version 2.0 Beta for BATTLETECH v1.1.1
</p>

<h1 class="warn"> DOC OUTDATED </h1>
<p class="warn"> This documentation is outdated and is being updated. See settings.json for up to date description of settings. </p>

<p style="clear: both">
   This mod fixes, tweaks, and enhances the BATTLETECH game's attack experience, such as fixing various bugs, tune down roll correction, show heat and stability numbers, and a detailed attack log.
</p>
<p>
   This mod does <i>not</i> modify game data.  Saves made with this mod on will <i>not</i> be affected by disabling or removing this mod.
</p>
<p>
   All features of this mod can be customised by editing this mod's "settings.json" as a text file.
   If the file does not exists, it will be created upon game launch after the mod is enabled and loaded.
   Advanced (almost fancy) features can be enabled, enhancements can be disabled, and tweaks can be fine tuned.
</p>

<details>
   <summary><h2>Change Log</h2></summary>
   <dl>
      <dt>Current Version 2.0 Beta
      <dd>Big architecture update, some speed ups, and more safeguards.
      <dd>New: Persistent settings in settings.json instead of mod.json. Auto-upgrade settings.json of old releases.
      <dd>New: Fix Multi-Shot back out.
      <dd>New: Fix paper doll's rear structure display.
      <dd>New: Fix the Grey Head disease which prevents all mechs from being headshoted during and after a boss fight.
      <dd>New: Force damage to be integer to avoid "0 hp location".
      <dd>New: Change styles of targeting lines by their status.
      <dd>New: Fix Multi-Shot back out.
      <dd>New: Show heat and stability numbers in combat.
      <dd>New: Unlock Melee and DFA positioning.
      <dd>New: Changing hit modifier steps and range.
      <dd>New: Allow net bonus hit modifier, height penalty, and/or diminishing modifier.
      <dd>New: A new attack log system that is faster, detailed, and bug fixed.
      <dd>Fix: Defer combat constants access to improves compatibility and robustness.
      <dd>Fix: Attack log now fill in all blanks even when missing.
      <dd>Change: Re-enable hit location fix by default on ver 1.1.1 and up.
      <dd>Change: Minimised settings dependency, e.g. ShowDecimalCalledChance no longer depends on ShowRealMechCalledShotChance and ShowRealVehicleCalledShotChance.
      <dd>Settings: Log folder may now be set. Decimal chance formats upgraded to free form string.
   </dl>
   <dl>
      <dt>2018-06-28 Version 1.0.1
      <dd>Fix: Fix vehicle called shot no longer float mech location name.
      <dd>Fix: Autodetect Log directory.
      <dd>Fix: Cap accuracy between 0 and 100.
      <dd>Fix: Override called shot percent cap when ShowRealWeaponHitChance is true but ShowDecimalHitChance is false.
      <dd>Fix: Auto-bypass Hit Location bug fix on 1.1.1 and up.
   </dl>
   <dl>
      <dt>2018-06-21 Version 1.0.0
      <dd>Initial version with vehicle called shot fix, hit location fix, clustering called shot, roll correction adjustment, miss streak adjustment, and roll log.
   </dl>
</details>

<details>
   <summary><h2>Install Instructions</h2></summary>
   <p>
      Most BATTLETECH mods requires BTML and ModTek. This mod is no exception.
      The <a href="https://github.com/Mpstark/ModTek/wiki">ModTek wiki</a> may have more up-to-date <a href="https://github.com/Mpstark/ModTek/wiki/The-Drop-Dead-Simple-Guide-to-Installing-BTML-&-ModTek-&-ModTek-mods">install instructions</a>.
   </p>
   <details>
      <summary><h3>Step 1: Find Game Folder </h3></summary>
      <ol>
         <li> Open File Explorer. Click "This PC" on the left. In the top right corner it should says "Search This PC".
         <li> Click on it and type "BATTLETECH", without the quote. Your PC may take a while to do the search.
         <li> If you get one result, that is the game folder.
         <li> If you get multiple results, right click each one and "Open in new window". This will keep the search result untouched.
         <li> The one that has a "BattleTech_Data" folder is your game folder. You should also see the BattleTech icon and BattleTechLauncher icon.
      </ol>
   </details>
   <details>
      <summary><h3>Step 2: Install BTML</h3></summary>
      <ol>
         <li> Download and Extract <a href="https://github.com/Mpstark/BattleTechModLoader/releases
         ">BTML</a>. You should see three files - two dll and one exe.
         <li> Find the BATTLETECH\BattleTech_Data\Managed folder (where BATTLETECH is your game folder.)</li>
         <li> The correct folder should have lots of file. One of them should be "Assembly-CSharp.dll". If you don't see this file you're in the wrong folder.
         <li> Copy all three files to it. Then run "BattleTechModLoaderInjector". Say yes if it ask whether to overwrite.
         <li> It should says "Injection complete!" or "Assembly-CSharp.dll already injected".
         <li> The Injector need to be run once after every game update.  If all your mods suddenly stop working, this is normally what happened.
      </ol>
   </details>
   <details>
      <summary><h3>Step 3: Install ModTek</h3></summary>
      <ol>
         <li> Download <a href="https://github.com/Mpstark/ModTek/releases">ModTek.dll</a>
         <li> Create a "Mods" folder in the game folder (Right click in the folder, New > Folder) and put the dll in it
         <li> Launch the Game. At the bottom of main menu there is a version string. Part of it should be "W/ MODTEK".
      </ol>
   </details>
   <details open>
      <summary><h3>Step 4: Install this mod</h3></summary>
      <ol>
         <li> Download and extact this mod to the Mods folder of the game.
         <li> i.e. BATTLETECH\Mods\AttackImprovementMod\ should contains "mod.json", "AttackImprovementMod.dll", and other files and folders.
         <li> Exit and Re-launch the game and the mod should be loaded.  If it doesn't, BTModLoader.log will log why.
         <li> This mod also keeps its own log of what it can or cannot try to modify in the mod folder.
      </ol>
   </details>
</details>

<details open>
   <summary><h2>Features</h2></summary>
   <p>
      The default options aim to enhance your BattleTech experience while staying close to the vanilla balance, and several features are disabled or tuned down.
      If you want to customised your experience, this section describes each features and their settings.
   </p>
   <p>
      Each feature can be individually enabled, disabled, or sometimes adjusted.
      For example, attack log is disabled by default, but can be set to log basic attack info (who attacked who), or plus shot info (weapon, hit roll, hit chance), or plus hit location, all the way down to which slot and component got crit and how it goes.
   </p>
   <p>
      Unlike many simpler mods, this mod is designed to run as fast as it can be, so don't worry about performance.
      Disabled features won't put any load on the game (does not modify any code), and the mod has more caching than the game itself.
      So, don't be afraid to tick things on and off.
   </p>
   <details open>
      <summary><h3>User Interface</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>Fix Multi-Target Back Out</h3></summary>
            <p>Setting: <code>FixMultiTargetBackout</code> (true/false, default true)
            <p>The game's Muti-Target back out (escape) is bugged. Backing out from first target will cancel the action, while second back out (regardless of target) will always cancel the whole thing.
            <p>This mod can make Multi-Target back out deselect targets one by one as expected.
         </details></li>

         <li> <details>
            <summary><h3>Fix Rear Structure Display</h3></summary>
            <p>Setting: <code>FixPaperDollRearStructure</code> (true/false, default true)<br>
            <p>The rear structure of the paper dolls are showing front structure on the reverse side because of a typo in the code.  If the front has armour, it means the damaged structure will not be displayed. This mod can fix both status panels and called shot paper dolls.
         </details></li>

         <li> <details>
            <summary><h3>Display structure damage through armor</h3></summary>
            <p>Setting: <code>PaperDollDivulgeUnderskinDamage</code> (true/false, default true)<br>
            <p>Not sure why the game didn't do this. When enabled, armour of damaged structure will be striped.  Pretty nice when doing called shot!
         </details></li>

         <li> <details>
            <summary><h3>Show Heat and Stability Numbers</h3></summary>
            <p>Setting: <code>ShowHeatAndStab</code> (true/false, default true)
            <p>Show heat and stability number in the selection panel (bottom left) and targeting panel (top center).
            <p>When planning your action, the numbers will display current state and predicted state.  The prediction is supplied by the game and is subject to all its quirks and bugs.
         </details></li>

         <li> <details>
            <summary><h3>Show Unit Tonnage</h3></summary>
            <p>Setting: <code>ShowUnitTonnage</code> (true/false, default true)
            <p>Show mech and vehicle tonnage in selection and target panel when enabled.
         </details></li>

         <li> <details>
            <summary><h3>(Advanced) Show Corrected Hit Chance</h3></summary>
            <p>Setting: <code>ShowCorrectedHitChance</code> (true/false, default false)<br>
            <p>It's one thing to fudge the rolls.  It is another to let you know.
            Enabling this would show the corrected hit chance in weapon panel.
            <p>Renamed from the "ShowRealWeaponHitChance" settings since version 2.0.
         </details></li>

         <li> <details>
            <summary><h3>Show Decimal Hit Chance</h3></summary>
            <p>Setting: <code>HitChanceFormat</code> (free string, default "")<br>
            <p>Use Microsoft C# <a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/0c899ak8(v=vs.90)">String.Format syntax</a> to format called shot location chances.
            <p>Set to "{0:0.0}%" to always show one decimal, or "{0:0.00}%" for two decimals.
            <p>When empty AND HitChanceStep is 0, will use "{0:0.#}%" to optionally show hit chance to one decimal point.
            <p>Replaces the "ShowDecimalHitChance" settings since version 2.0.
         </details></li>
      </ul>
   </details>
   <details open>
      <summary><h3>Targeting Line</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>Change Widths of Targeting Lines</h3></summary>
            <p>Setting: <code>LOSWidth</code> (0.1 to 10, default 3) <br>
            Scale width of all targeting lines (direct, indirect, blocked, can't attack etc.).
            Set to 0 to leave at game default.
            Default is 3 meaning the widths are tripled from default. <br>

            <p>Setting: <code>LOSWidthBlocked</code> (0.1 to 20, default 2) <br>
            Scale width of obstructed part of an obstructed targeting lines, which is thinner than other lines by default. <br>
            Set to 0 to leave at game default. <br>
            Default is 2 which is about 2.5 times the game's default.
         </details></li>

         <li> <details>
            <summary><h3>Change Widths of Obstruction Marker</h3></summary>
            <p>Setting: <code>LOSMarkerBlockedMultiplier</code> (0 to 10, default 1.5)
            <p>Scale the obstruction marker of targeting lines, the "light dot" that split the obstructed line into two. 2 means double width and height, 0.5 means half-half. <br>
            Set to 1 to leave at game default. <br>
            Set to 0 will not remove them from game but will effectively hide them.
         </details></li>

         <li> <details>
            <summary><h3>Styles and Colours the Targeting Lines</h3></summary>

            <p>Setting: <code>LOSIndirectDotted</code> (Default true, game default false)<br>
               Setting: <code>LOSNoAttackDotted</code> (Default true)<br>
               Setting: <code>LOSMeleeDotted</code> (Default false)<br>
               Setting: <code>LOSClearDotted</code> (Default false)<br>
               Setting: <code>LOSBlockedPreDotted</code>  (Default false)<br>
               Setting: <code>LOSBlockedPostDotted</code> (Default false)<br>
               Setting: <code>LOSMeleeColor</code> (Default "")<br>
               Setting: <code>LOSClearColor</code> (Default "")<br>
               Setting: <code>LOSBlockedPreColor</code><br>
               Setting: <code>LOSBlockedPostColor</code><br>
               Setting: <code>LOSIndirectColor</code> (Default "")<br>
               Setting: <code>LOSNoAttackColor</code> (Default "")<br>

            <p>Set the colour and style of various targeting lines.
            Obstructed lines has two parts. The part before obstruction is Pre, and the part after is Post.

            <p>Colours are either empty or in HTML hash syntax.  #F00 = red, #0F0 = green, #00F = blue, #FFF = white, #888 = grey, #000 = black.  Four parts means RGBA, while three parts mean full opacity RGB. Support full and short form. e.g. #28B = #2288BB = #2288BBFF.
         </details></li>

         <li> <details>
            <summary><h3>Refine or Rough Fire Arc and Jump Arc</h3></summary>
            <p>Setting: <code>ArcLinePoints</code> (2 to 1000, default 48, game default 18)
            <p>On a high resolution monitor it is easy to see the hard corners of the arc of indirect targeting lines.  Lines are quick to draw, so this mod will happily improves their quality for you. <br>
            Set to 2 to make them flat like other lines.
         </details></li>

         <li> <details>
            <summary><h3>Fix LoS Inconsistency between Walk and Jump</h3></summary>
            <p>Setting: <code>FixLosPreviewHeight </code> (true/false, default true)<br>
            <p>Walk and Jump will sometimes predicts different Line of Sight, because the walking preview height is slight different from jumping preview height.  This mod can make the heights the same.
         </details></li>
      </ul>
   </details>
   <details open>
      <summary><h3>Called Shot</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>Enable Vehicle Called Shot</h3></summary>
            <p>Setting: <code>FixVehicleCalledShot</code> (true/false, default true)<br>
            <p>Called shot have absolutely no effect on vehicles, probably because there isn't enough time to implement it.
            <p>In the code, Mech Locations and Vehicle Locations are two separate data type, meaning there are two set of states and methods to handle hit location.
            And vehicle's called shot handling is incomplete. You can pick a called shot location, but it never reach the hit location routine.
            This can be verified by disabling this setting and enabling attack log (below).
         </details></li>

         <li> <details>
            <summary><h3>Make Boss Head Stays Grey</h3></summary>
            <p>Setting: <code>FixBossHeadCalledShotDisplay </code> (true/false, default true)<br>
            <p>Did you know that grey head in called shot popup is actually a bug?
            (I <i>hope</i> it is a bug.)
            If you try to call shot the boss before anyone is attacked, such as right after a load, the head is actually selectable!
            This is most apparent with FixGreyHeadDisease on, since the head will be always available.
            <p>So, yeah, as a responsible mod, this small display issue can be fixed too.  Or you can leave it on if you like to imagine that you are trying it head and it keeps twisting the head away from every single shot.
         </details></li>

         <li> <details>
            <summary><h3>Enable Clustering Called Shot</h3></summary>
            <p>Setting: <code>CalledShotUseClustering</code> (true/false, default true)<br>
            <p>When enabled, called shot has a higher chance to hit adjacent locations.
            For example, head called shot would bias the head, but also the three torsos to a lesser degree.
            <p>This is the default behaviour before game version 1.0.4,
            which caused very low called head shot chances because head is normally excluded from clustering.
            In fact, called shot actually had a <a href="https://steamcommunity.com/app/637090/discussions/0/1697176044370891096/">lower chance</a>
            to hit the head than blind shots.
            <p>This mod was intended to fix it, but 1.1 came out first.
            So this mod now restores the clustering effect, instead of fixing the head called shot bug.
            Clustering strength can be modified in <code>constants\CombatGameConstants.json</code>
            <p>Note that this does not apply to Vehicle called shot;
            the default vehicle clustering is a real mess, and even when fixed there are too few locations to cluster.
         </details></li>

         <li> <details>
            <summary><h3>Adjust Called Shot Effect vs Mech</h3></summary>
            <p>Setting: <code>MechCalledShotMultiplier</code> (0 to any small number, default 0.33)<br>
            <p>When clustering called shot is enabled, chance to hit called locations will be amplified by clustering weight.
            At original strength, this can cause head hit chance is up to 40%.
            <p>This setting let you tune called shot's weight multipliers.
            Default is 0.33 to counter the effect of CalledShotClusterStrength.
            Set to 1.0 would retain original multiplier, while 0.0 will removing it leaving only clustering effect (if enabled).
         </details></li>

         <li> <details>
            <summary><h3>Adjust Called Shot Effect vs Vehicle</h3></summary>
            <p>Setting: <code>VehicleCalledShotMultiplier</code> (0 to any small number, default 0.75)<br>
            <p>Called shot didn't work on vehicles without modding.
            Once that is fixed, unmodified called shot is pretty powerful on vehicles because of its low number of locations.
            This setting tries to balance that.
         </details></li>

         <li> <details>
            <summary><h3>Fix Called Shot Popup</h3></summary>
            <p>Setting: <code>ShowRealMechCalledShotChance</code> (true/false, default true)<br>
            <p>Setting: <code>ShowRealVehicleCalledShotChance</code> (true/false, default true)<br>
            <p>When enabled, the popups will reflect modded hit distribution.
            Also, if vehicle called shot fix is disabled, vehicle called shot chance will be updated to reflect disabled called shot.
         </details></li>

         <li> <details>
            <summary><h3>(Advancex) Show Hit Distribution in Decimal</h3></summary>
            <p>Setting: <code>CalledChanceFormat</code> (string, default "")<br>
            <p>Use Microsoft C# <a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/0c899ak8(v=vs.90)">String.Format syntax</a> to format called shot location chances.
            <p>Set to "{0:0.0}%" to always show one decimal, or "{0:0.00}%" for two decimals.
            <p>Replaces the "ShowDecimalCalledChance" settings since version 2.0.
         </details></li>
      </ul>
   </details>
   <details open>
      <summary><h3>Hit Modifiers</h3></summary>
      <ul>
      </ul>
   </details>
   <details open>
      <summary><h3>Roll Adjustments</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>Adjust Roll "Correction"</h3></summary>
            <p>Setting: <code>RollCorrectionStrength</code> (0 to 2, default 0.5)<br>
            <p>It is no secret that the game fudge all hit rolls, called a "correction".
            As a result, real hit chances are shifted away from 50%,
            for example 75% becomes 84% while 25% becomes 16%.
            This can create a rift between what you see and what you get,
            especially on low chance shots.
            <p>This mod does not aim to completely disable roll adjustment, and thus default to half its strength.
            You can set the strength to zero to disable it, 1 to use original formula, 2 to amplify it, or any value in between.
            See compatibility section (below) for the formula.
         </details></li>

         <li> <details>
            <summary><h3>(Advanced) Adjust Miss Streak Threshold</h3></summary>
            <p>Setting: <code>MissStreakBreakerThreshold</code> (0 to 1, default 0.5)<br>
            <p>In addition to roll adjustment, the game also has a "miss streak breaker".
            Whenever you miss an attack of which hit chance &gt; 50%,
            the streak breaker will kicks in and adjust your hit chance up after and on top of roll adjustment.
            The bonus accumulates until you land a hit (regards of hit chance), at which point it resets to 0.
            <p>This setting let you adjust the threshold.
            0.75 means it applies to attack of which hit chance &gt; 75%, or 80% and up in other words.
            Set to 0 enable it for all attack, or set to 1 to effectively disable it.
            Default is 0.5 which is the game's default.
         </details></li>

         <li> <details>
            <summary><h3>(Advanced) Adjust Miss Streak Bonus</h3></summary>
            <p>Setting: <code>MissStreakBreakerDivider</code> (-100 to any small number, default 5)<br>
            <p>For every miss that crosses the threshold, the threshold is deduced from hit chance, then divided by 5.
            The result is then added as streak breaker bonus.
            <p>Set this setting to a positive number to override the divider.  For example at threshold 0.5 and divider 3,
            a 95% miss result in (95%-0.5)/3 = 15% bonus to subsequence shots until hit.
            Default is 5 which is the game's default.
            <p>Set this setting to zero or negative integer to replace it with a constant value.
            For example -5 means each triggering miss adds 5% bonus, and -100 will make sure the next shot always hit.
         </details></li>

         <li> <details>
            <summary><h3> Allow free Melee and DFA positioning </h3></summary>
            <p>Setting: <code>IncreaseMeleePositionChoice</code> (true/false, default true)<br>
            <p>Setting: <code>IncreaseDFAPositionChoice</code> (true/false, default true)<br>
            <p>When enabled, melee and DFA can use all available positions, instead of nearest three.
            <hr>
            <p>Setting: <code>UnlockMeleePositioning</code> (true/false, default true)<br>
            <p>When enabled, free player units from standing still when target is already in melee range.
         </details></li>
      </ul>
   </details>

   <details open>
      <summary><h3>Hit Locations</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>Precise Hit Location Distribution</h3></summary>
            <p>Setting: <code>FixHitDistribution</code> (true/false, default true)<br>
            <p>Game version 1.1 introduced degrading called shot effect for SRM and MG,
            but because the code that determine hit distribution is not designed for fraction called shot weight,
            the actual distribution is slightly bugged.
            <p>This mod can replace the hit distribution routine with an improved version that has better precision.
            On game version 1.1.0 and before, this would also fix the bug that cause abnormally high head hit chances.
            <hr>
         </details></li>

         <li> <details>
            <summary><h3>Fix Grey Head Disease</h3></summary>
            <p>Setting: <code>FixGreyHeadDisease</code> (true/false, default true)<br>
            <p>When anyone, friends or foes, attacks a headshot immune character (at least two in the campaign), all attacks from the same side will never hit the head ever again.  Every one's head will be grey.  I call it the grey head disease.
            <p>This fix will make sure that the disease is confined to the boss and not spread.
            <p>If FixBossHeadCalledShotDisplay is false, the boss's head will be selectable for called shot but it is just an illusion.  Your shots still can't hit the head.
         </details></li>
      </ul>
   </details>

   <details open>
      <summary><h3>Attack Logs</h3></summary>
      <ul>
         <li> <details>
            <summary><h3>(Advanced) Attack Log</h3></summary>
            <p>Setting: <code>AttackLogLevel</code><br> ("None", "Attack", "Shot", "Location", "Damage", "Critical", or "All", default "None")<br>
            <p>When enabled, the mod will keep an attack log in the mod's folder, called Log_Attack.txt.
            <p>The settings are progressive.  Attack info is fully included by Shot level, Shot info is fully included by Location level, etc.
            The deeper the level, the more the mod needs to eavesdrops and the higher the chance things will go wrong.
            Otherwise, the log should be pretty fast relative to the game.
            <ul>
               <li><b>None</b>: It is a bug if you see a log file at this log level.  Or the file is a ghost that comes back to haunt you, in which case you should seek the church.
               <li><b>Attack</b>: Time, Attacker (team, pilot, mech), Target (team, pilot, mech), Direction, Range, Combat Id, and Action Id. (Unique per combat/action and can be used to produce by-action or by-combat data.)
               <li><b>Shot</b>: For each shot, log the Attack Roll, Hit Chance, related info, and Hit or Miss.
               <li><b>Location</b>: Location Roll, Hit Table, Called Shot, and of course  the Hit Location.
               <li><b>Damage</b>: Damage, Final Damaged Location, and Armor/HP of this location.
               Damage is determined in a different phase from hit and location, and is a rather complicated info to log.
               <li><b>Critical</b>: Crit Location, Crit Roll, Crit Slot, Crit Component, and the result of the crit.
               Crit is determined in yet another phase, so the log code is very <i>fun</i> to write.
               <li><b>All</b>: same as Critical for now.  More info may be added in the future, though I am not sure I wouldn't go crazy.  Would you believe logging is easily the most complicated feature of the mod?
            </ul>

            <p>Setting: <code>PersistentLog</code> (true/false, default false)<br>
            <p>When enabled, the attack log will not auto-clear on launch.

            <p>Setting: <code>LogFolder</code> (string, default "")<br>
            <p>Set path of mod log and attack log. Default is empty which will use mod folder.
         </details></li>
      </ul>
   </details>
</details>

<details>
   <summary><h2>Compatibility</h2></summary>
   <p>
      As stated in the beginning, this mod is not expected to change game data.
      If something goes wrong, you may disable conflicting features or the whole mod without affecting your save games.
   <p>
      By default, the mod will create a log called "Log_AIMAttackImprovementMod.txt" in the same folder as the dll location.
      It will log all errors that occurred in the mod code that can be reasonably detected.
      If you see an error in the log, it is extremely helpful if you can upload the log to GitHub as a new issue.
      The error may also hint at what features you can disable to hopefully bypass the error.
      For example an error that mentions "OverrideHitChanceDiminishing" should be avoidable if you turn off diminishing to hit modifier.
   <p>
      A few known mods whose features partially overlaps with this mod will be detected and this mod will selectively disable its own features to accommodate them:
      <ul>
      <li>true rng
      <li>color lines
      <li>meleemover
   <p>
      Although this section used to list each game code modified by this mod and how, it's proven to take too much time to update.
      This mod is free and open with a proper open source license, so feel free to look at the code to see how it works.
</details>


<details>
   <summary><h2>Modding this mod</h2></summary>
   <p>
      The <a href="https://github.com/Sheep-y/Attack-Improvement-Mod/">source code</a> of this mod is open and free. <br>
      You can take it and modify it, provided that you include <i>your</i> code when you distribute your work, and don't claim my work as yours.
      License: AGPL v3 - <a href="LICENSE.html">local</a> / <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">online</a>.
   </p>
   <p>
      If you know programming, you can follow these steps to see game code and learn how BATTLETECH mod works:
   </p>
   <ol>
      <li> Install <a href="https://www.visualstudio.com/downloads/">Visual Studio</a>, or VS. This mod is developed with VS 2017 Community Edition. You'll need the ".NET desktop development" workload.
      <li> Down and Run <a href="https://github.com/0xd4d/dnSpy/releases">DnSpy</a>
      <li> Select File &gt; Open, to open BATTLETECH\BattleTech_Data\Managed\Assembly-CSharp.dll.  This will load the assembly.  It contains most BATTLETECH code.
      <li> You may now search and browse the assembly!  For example in Edit &gt; Search you can type "GetCorrectedRoll" to find the method. Clicking on it will show you the roll correction code.
      <li> Right click on method name (or any identifier) and click "Analyse".  It'll help you find where and how the method is called, or its override hierarchy.
      <li> Analyse is very fast because it works with compiled code.  It is not 100% accurate, though, sometimes you'll want to exported code and search there instead.
      <li> Left click the assembly, then File > Export to Project. This will decompile all code which you can browse with other editor or IDE.
      <li> Head to the <a href="https://github.com/Mpstark/ModTek/wiki">ModTek wiki</a> to learn how to make a mod.  For a code mode like this one, you need to produce a <a href="https://github.com/Mpstark/ModTek/wiki/Writing-ModTek-DLL-mods">dll</a> and perhaps a <a href="https://github.com/Mpstark/ModTek/wiki/The-mod.json-Format">"mod.json"</a>.
      <li> The code of this mod is available on GitHub: <a href="https://github.com/Sheep-y/Attack-Improvement-Mod/">https://github.com/Sheep-y/Attack-Improvement-Mod/</a>.
      <li> You may notice that this patch manually calls Harmony to patch things, instead of using annotations. This gives me much better control. Read <a href="https://github.com/pardeike/Harmony/wiki">Harmony wiki</a> to learn how it works.
   </ol>
</details>


<style>
   body { margin: 0 auto; max-width: 800px; }
   p, li { font-size: 110%; margin-bottom: 1ex; margin-top: 1ex; }
   h1, h2, h3 { display: inline-block; margin: 0.5ex 0; }
   ul, ol { margin-top: 0.5ex; }
   a { text-decoration: none; }
   a:hover { text-decoration: underline; }
   dt { margin-top: 0.5ex; }
</style>
